# 数英网数据统计与智能对话系统 - 使用说明

## 🎯 系统简介

这是一个集成了数据统计和AI智能对话的Web界面系统，可以：
- 📊 统计品牌总数和项目总数
- 🤖 通过AI助手进行智能问答
- 📈 实时数据更新和分析
- 🌐 现代化Web界面

## 🚀 快速开始

### 第一步：一键启动
1. **双击** `启动系统.bat` 文件
2. 系统会自动检查环境并启动
3. 浏览器会自动打开显示界面

### 第二步：配置API密钥（可选）
如果您想使用AI对话功能：
1. **双击** `配置管理器.bat` 文件
2. 在界面中点击"获取密钥"按钮
3. 按照提示获取Gemini API密钥
4. 将密钥粘贴到配置中并保存

## 📋 功能说明

### 左侧统计区域
- **品牌总数**: 显示从Excel文件中统计的唯一品牌数量
- **项目总数**: 显示从Excel文件中统计的唯一项目数量
- **刷新按钮**: 手动更新统计数据

### 右侧对话区域
- **AI助手**: 基于Gemini的智能问答系统
- **自然语言**: 支持中文自然语言查询
- **实时对话**: 支持连续对话和上下文理解

## 💬 对话示例

您可以向AI助手询问：

### 数据查询
- "有多少个品牌？"
- "统计一下项目数量"
- "最近有哪些新项目？"

### 品牌分析
- "分析可口可乐的营销策略"
- "宝马和奔驰的广告有什么不同？"
- "哪些品牌最活跃？"

### 趋势洞察
- "今年的营销趋势是什么？"
- "汽车行业有什么新创意？"
- "对比不同行业的营销特点"

## ⚙️ 配置说明

### 配置文件
系统使用 `config.env` 文件存储配置，包括：
- Gemini API密钥
- 服务器端口和地址
- 数据文件夹路径
- 浏览器设置

### 配置管理
- **图形界面**: 运行 `配置管理器.bat`
- **手动编辑**: 直接编辑 `config.env` 文件

## 📁 文件结构

```
网页爬虫/
├── 启动系统.bat              # 一键启动脚本
├── 配置管理器.bat            # 配置管理脚本
├── config.env               # 配置文件
├── simple_dashboard.html    # Web界面
├── web_server.py           # Web服务器
├── data/                   # Excel数据文件夹
└── output/                 # 输出文件夹
```

## 🔧 故障排除

### 常见问题

#### 1. 启动失败
- 确保已安装Python 3.7+
- 检查虚拟环境是否正确创建
- 查看错误信息并修复

#### 2. 数据不显示
- 确保 `data/` 文件夹中有Excel文件
- 检查Excel文件是否包含"所有项目合并"sheet
- 运行数据分析脚本：`python data_analyzer.py`

#### 3. AI对话不可用
- 检查是否设置了Gemini API密钥
- 确保网络连接正常
- 查看API密钥是否正确

#### 4. 端口被占用
- 修改 `config.env` 中的 `SERVER_PORT` 设置
- 或关闭占用端口的其他程序

## 📞 技术支持

如遇到问题，请检查：
1. **环境检查**: 运行 `启动系统.bat`
2. **配置检查**: 运行 `配置管理器.bat`
3. **日志文件**: 查看控制台输出
4. **数据文件**: 确认Excel文件格式正确

## 🎨 界面特性

- **响应式设计**: 支持桌面和移动设备
- **现代化UI**: 渐变背景、毛玻璃效果
- **实时更新**: 自动刷新统计数据
- **智能对话**: 自然语言交互

---

**版本**: 1.0.0  
**更新时间**: 2025-08-06  
**兼容性**: Windows 10+, Python 3.7+ 